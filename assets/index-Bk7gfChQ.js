import{j as b}from"./jsx-runtime-Cw0GR0a5.js";import{r as i}from"./index-CTjT7uj6.js";import{c as E}from"./createDragHandler-DDNYS428.js";import{c as v}from"./clamp-co6UzHBn.js";import{C as X}from"./index-VWCGd7j2.js";import{C as Y}from"./index-B1Pf1uP_.js";function D(s){const e=s/255;return e<=.04045?e/12.92:((e+.055)/1.055)**2.4}function k(s){const e=D(s.r),n=D(s.g),t=D(s.b);return .2126*e+.7152*n+.0722*t}function p(s,e){const n=k(s),t=k(e),u=Math.max(n,t),r=Math.min(n,t);return(u+.05)/(r+.05)}function K(s,e,n,t=0){const u=p(s,e),r=p(s,n);return u>r+t||u>r?e:n}const P={r:255,g:255,b:255},A={r:0,g:0,b:0},ee={r:255,g:255,b:255};function O(s,e=0){return K(s,P,A,e)}function C(s){let e=0,n=0,t=0;const u=s.h,r=s.s,o=s.v,c=Math.floor(u/60),a=u/60-c,m=o*(1-r),l=o*(1-r*a),f=o*(1-r*(1-a));switch(c%6){case 0:e=o,n=f,t=m;break;case 1:e=l,n=o,t=m;break;case 2:e=m,n=o,t=f;break;case 3:e=m,n=l,t=o;break;case 4:e=f,n=m,t=o;break;case 5:e=o,n=m,t=l;break}return{r:Math.round(e*255),g:Math.round(n*255),b:Math.round(t*255)}}function L({r:s,g:e,b:n}){return`rgb(${s},${e},${n})`}function B(s,e,n=500){const t=i.useRef(),u=i.useRef(!1);return i.useCallback(()=>{clearTimeout(t.current),u.current===!1&&(s==null||s()),u.current=!0,t.current=window.setTimeout(()=>{e==null||e(),u.current=!1,clearTimeout(t.current)},n)},[s,e,n])}function N(s,e=-3){return i.useMemo(()=>L(O(C(s),e)),[s,e])}function U(){const s=i.useRef(null),e=i.useMemo(()=>{const n=t=>{t.preventDefault();const u=()=>{document.removeEventListener("touchmove",n),document.removeEventListener("touchend",u)};document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",u)};return n},[]);return i.useEffect(()=>{const n=s.current;if(n)return n.addEventListener("touchstart",e,{passive:!1}),()=>{n.removeEventListener("touchstart",e)}},[e]),s}function W(s,e){const n=s.canvas.width,t=s.canvas.height,u=s.getImageData(0,0,n,t),r=u.data;for(let o=0;o<t;o++)for(let c=0;c<n;c++){const a=(o*n+c)*4,{r:m,g:l,b:f}=C({h:e,s:c/t,v:1-o/n});r[a]=m,r[a+1]=l,r[a+2]=f,r[a+3]=255}s.putImageData(u,0,0)}const S=i.memo(function(e){const n=U(),t=i.useRef(null);i.useEffect(()=>{var r;n.current&&(t.current=(r=n.current)==null?void 0:r.getContext("2d",{willReadFrequently:!0}),t.current&&(t.current.imageSmoothingEnabled=!1,t.current.imageSmoothingQuality="low"))},[n.current]),i.useEffect(()=>{t.current&&W(t.current,e.hue)},[e.hue]);const u=i.useMemo(()=>E({onDown:r=>{var g;(g=e.onStart)==null||g.call(e);const c=r.currentTarget.getBoundingClientRect(),a=r.clientX-c.left,m=r.clientY-c.top,l=a/e.width,f=1-m/e.height;return e.onChange(l,f),e.onDownChange(!0),{startX:r.clientX,startY:r.clientY}},onMove:(r,o)=>{if(!o)return;const c=r.currentTarget;if(!(c instanceof HTMLCanvasElement))return;const a=c.getBoundingClientRect(),m=r.clientX-a.left,l=r.clientY-a.top,f=v(m/e.width,0,1),g=v(1-l/e.height,0,1);e.onChange(f,g)},onUp:()=>{var r;e.onDownChange(!1),(r=e.onEnd)==null||r.call(e)}}),[e.height,e.width,e.onChange,e.onDownChange,e.onStart,e.onEnd]);return b.jsx("canvas",{onPointerDown:u,width:e.width,height:e.height,style:{width:e.width,height:e.height},ref:n})});S.__docgenInfo={description:"",methods:[],displayName:"SVCanvas",props:{nobRadius:{required:!1,tsType:{name:"number"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(saturation: number, value: number) => void",signature:{arguments:[{type:{name:"number"},name:"saturation"},{type:{name:"number"},name:"value"}],return:{name:"void"}}},description:""},hue:{required:!0,tsType:{name:"number"},description:""},saturation:{required:!1,tsType:{name:"number"},description:""},showLoupe:{required:!1,tsType:{name:"boolean"},description:""},value:{required:!1,tsType:{name:"number"},description:""},width:{required:!0,tsType:{name:"number"},description:""},height:{required:!0,tsType:{name:"number"},description:""},onStart:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDownChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(isDown: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isDown"}],return:{name:"void"}}},description:""}}};function F({nobRadius:s=8,onChange:e,hue:n,saturation:t=1,showLoupe:u=!0,value:r=1,width:o=192,height:c=192,...a}){const m=t*o,l=(1-r)*c,[f,g]=i.useState(!1),T=B(a.onStart,a.onEnd),M=i.useMemo(()=>d=>{if(d.key==="ArrowLeft"||d.key==="ArrowRight"){T();const y=.01*(d.key==="ArrowLeft"?-1:1),w=v(t+y,0,1);e(w,r),d.preventDefault()}else if(d.key==="ArrowUp"||d.key==="ArrowDown"){T();const y=.01*(d.key==="ArrowUp"?1:-1),w=v(r+y,0,1);e(t,w),d.preventDefault()}},[t,r,e,T]),R=i.useCallback(()=>{g(!0)},[]),V=i.useCallback(()=>{g(!1)},[]),_=i.useMemo(()=>E({onDown:d=>{var h;return g(!0),(h=a.onStart)==null||h.call(a),{startX:d.clientX,startY:d.clientY,s:t,v:r}},onMove:(d,h)=>{if(!h)return;const y=d.clientX-h.startX,w=d.clientY-h.startY,j=v(h.s+y/o,0,1),H=v(h.v-w/c,0,1);e(j,H)},onUp:()=>{var d;g(!1),(d=a.onEnd)==null||d.call(a)}}),[e,t,r,o,c,a.onEnd,a.onStart]),q=i.useMemo(()=>L(C({h:n,s:t,v:r})),[n,t,r]),x=i.useMemo(()=>({h:n,s:t,v:r}),[n,t,r]),I=N(x);return b.jsxs("div",{className:"cmpui_sv-picker__root",tabIndex:0,onKeyDown:M,onFocus:R,onBlur:V,children:[b.jsx(S,{width:o,height:c,hue:n,onChange:e,onDownChange:g}),u&&f&&b.jsx(Y,{nobRadius:s,x:m,y:l,color:q}),b.jsx(X,{className:"cmpui_sv-picker__nob",fill:q,onPointerDown:_,radius:s,strokeColor:I,strokeWidth:2,x:m,y:l})]})}F.__docgenInfo={description:"",methods:[],displayName:"SVPicker",props:{nobRadius:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"8",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(saturation: number, value: number) => void",signature:{arguments:[{type:{name:"number"},name:"saturation"},{type:{name:"number"},name:"value"}],return:{name:"void"}}},description:""},hue:{required:!0,tsType:{name:"number"},description:""},saturation:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},showLoupe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},value:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"192",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"192",computed:!1}},onStart:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{F as S,ee as W,U as a,N as b,O as g,C as h,L as r,B as u};
