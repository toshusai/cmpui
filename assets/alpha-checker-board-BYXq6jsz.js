import{j as X}from"./jsx-runtime-Cw0GR0a5.js";import{r}from"./index-CTjT7uj6.js";import{c as M}from"./createDragHandler-DDNYS428.js";function O(u,i,o,l){r.useEffect(()=>{if(u.current!==null)return u.current.addEventListener(i,o,l),()=>{u.current!==null&&u.current.removeEventListener(i,o)}},[l,o,i,u])}function _({trackPadMoveScaleX:u=1,trackPadMoveScaleY:i=1,pointerDownZoomScale:o=100,minScale:l,maxScale:y,children:k,content:z,view:e,mode:n,onChangeView:m,style:b,...E}){const d=r.useRef(null),[g,c]=r.useState("auto"),q=r.useRef(n),p=r.useCallback((t,a,f)=>{var T;if(!d.current)return;let s=1+f/200;const R=d.current.getBoundingClientRect();if(!((T=d.current.parentElement)==null?void 0:T.getBoundingClientRect()))return;const P=t-R.left,C=a-R.top,Y=P-e.x,v=C-e.y;y!==void 0&&e.scale*s>y?s=y/e.scale:l!==void 0&&e.scale*s<l&&(s=l/e.scale),m({x:e.x+Y-Y*s,y:e.y+v-v*s,scale:e.scale*s})},[e,m,y,l]);O(d,"wheel",r.useCallback(t=>{const a=Number.isInteger(t.deltaY),f=t.ctrlKey||t.metaKey;if(a&&!f){m({x:e.x-t.deltaX*u,y:e.y-t.deltaY*i,scale:e.scale}),t.preventDefault();return}p(t.clientX,t.clientY,-t.deltaY),t.preventDefault()},[e,m,p,i,u]),r.useMemo(()=>({passive:!1}),[])),r.useEffect(()=>{c(n==="pan"?"grab":n==="zoom-in"?"zoom-in":n==="zoom-out"?"zoom-out":"auto"),q.current=n},[n]);const x=r.useMemo(()=>M({onDown:t=>n!=="pan"?!1:(c("grabbing"),{startX:t.clientX,startY:t.clientY,startOSX:e.x,startOSY:e.y}),onMove:(t,a)=>{if(a===void 0)return;const f=a.startX-t.clientX,s=a.startY-t.clientY;m({x:a.startOSX-f,y:a.startOSY-s,scale:e.scale})},onUp:()=>{q.current==="pan"?c("grab"):c("auto")}}),[n,e,m]),N=r.useCallback(t=>{n==="zoom-in"?p(t.pageX,t.pageY,o):n==="zoom-out"?p(t.pageX,t.pageY,-o):x(t)},[n,x,o,p]),j=r.useMemo(()=>({position:"absolute",pointerEvents:"none",transformOrigin:"0 0",top:`${e.y}px`,left:`${e.x}px`,transform:`scale(${e.scale})`}),[e.x,e.y,e.scale]),D=r.useMemo(()=>({cursor:g,...b}),[g,b]);return X.jsxs("div",{className:"cmpui_canvas-view__root",tabIndex:-1,ref:d,onPointerDown:N,style:D,...E,children:[X.jsx("div",{style:j,children:z}),k]})}_.__docgenInfo={description:"",methods:[],displayName:"CanvasView",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},content:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},onChangeView:{required:!0,tsType:{name:"signature",type:"function",raw:"(view: View) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
  scale: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}},{key:"scale",value:{name:"number",required:!0}}]}},name:"view"}],return:{name:"void"}}},description:""},view:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
  scale: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}},{key:"scale",value:{name:"number",required:!0}}]}},description:""},mode:{required:!1,tsType:{name:"union",raw:'"pan" | "zoom-in" | "zoom-out" | "default"',elements:[{name:"literal",value:'"pan"'},{name:"literal",value:'"zoom-in"'},{name:"literal",value:'"zoom-out"'},{name:"literal",value:'"default"'}]},description:""},minScale:{required:!1,tsType:{name:"number"},description:""},maxScale:{required:!1,tsType:{name:"number"},description:""},mouseZoomScale:{required:!1,tsType:{name:"number"},description:""},trackPadZoomScale:{required:!1,tsType:{name:"number"},description:""},trackPadMoveScaleX:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},trackPadMoveScaleY:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},pointerDownZoomScale:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"100",computed:!1}}}};export{_ as C};
