import{j as v}from"./jsx-runtime-DtaoT6pD.js";import{r as d}from"./index-OjgoNOWw.js";import{c as S}from"./createDragHandler-nJMxlNVC.js";import{c as y}from"./clamp-xqaTU5Qn.js";import{C as X}from"./index-pk5nlV7d.js";import{C as Y}from"./index-3ZWm4lKU.js";import{u as K}from"./useTouchStartPrevent-SoOiKono.js";function D(a){const e=a/255;return e<=.04045?e/12.92:((e+.055)/1.055)**2.4}function k(a){const e=D(a.r),r=D(a.g),t=D(a.b);return .2126*e+.7152*r+.0722*t}function p(a,e){const r=k(a),t=k(e),i=Math.max(r,t),n=Math.min(r,t);return(i+.05)/(n+.05)}function P(a,e,r,t=0){const i=p(a,e),n=p(a,r);return i>n+t||i>n?e:r}const A={r:255,g:255,b:255},O={r:0,g:0,b:0},ne={r:255,g:255,b:255};function B(a,e=0){return P(a,A,O,e)}function C(a){let e=0,r=0,t=0;const i=a.h,n=a.s,o=a.v,u=Math.floor(i/60),s=i/60-u,m=o*(1-n),l=o*(1-n*s),f=o*(1-n*(1-s));switch(u%6){case 0:e=o,r=f,t=m;break;case 1:e=l,r=o,t=m;break;case 2:e=m,r=o,t=f;break;case 3:e=m,r=l,t=o;break;case 4:e=f,r=m,t=o;break;case 5:e=o,r=m,t=l;break}return{r:Math.round(e*255),g:Math.round(r*255),b:Math.round(t*255)}}function M({r:a,g:e,b:r}){return`rgb(${a},${e},${r})`}function N(a,e,r=500){const t=d.useRef(),i=d.useRef(!1);return d.useCallback(()=>{clearTimeout(t.current),i.current===!1&&(a==null||a()),i.current=!0,t.current=window.setTimeout(()=>{e==null||e(),i.current=!1,clearTimeout(t.current)},r)},[a,e,r])}function U(a,e=-3){return d.useMemo(()=>M(B(C(a),e)),[a,e])}function W(a,e){const r=a.canvas.width,t=a.canvas.height,i=a.getImageData(0,0,r,t),n=i.data;for(let o=0;o<t;o++)for(let u=0;u<r;u++){const s=(o*r+u)*4,{r:m,g:l,b:f}=C({h:e,s:u/t,v:1-o/r});n[s]=m,n[s+1]=l,n[s+2]=f,n[s+3]=255}a.putImageData(i,0,0)}const R=d.memo(function(e){const r=K(),t=d.useRef(null);d.useEffect(()=>{var n;r.current&&(t.current=(n=r.current)==null?void 0:n.getContext("2d",{willReadFrequently:!0}),t.current&&(t.current.imageSmoothingEnabled=!1,t.current.imageSmoothingQuality="low"))},[r.current]),d.useEffect(()=>{t.current&&W(t.current,e.hue)},[e.hue]);const i=d.useMemo(()=>S({onDown:n=>{var g;(g=e.onStart)==null||g.call(e);const u=n.currentTarget.getBoundingClientRect(),s=n.clientX-u.left,m=n.clientY-u.top,l=s/e.width,f=1-m/e.height;return e.onChange(l,f),e.onDownChange(!0),{startX:n.clientX,startY:n.clientY}},onMove:(n,o)=>{if(!o)return;const u=n.currentTarget;if(!(u instanceof HTMLCanvasElement))return;const s=u.getBoundingClientRect(),m=n.clientX-s.left,l=n.clientY-s.top,f=y(m/e.width,0,1),g=y(1-l/e.height,0,1);e.onChange(f,g)},onUp:()=>{var n;e.onDownChange(!1),(n=e.onEnd)==null||n.call(e)}}),[e.height,e.width,e.onChange,e.onDownChange,e.onStart,e.onEnd]);return v.jsx("canvas",{onPointerDown:i,width:e.width,height:e.height,style:{width:e.width,height:e.height},ref:r})});R.__docgenInfo={description:"",methods:[],displayName:"SVCanvas",props:{nobRadius:{required:!1,tsType:{name:"number"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(saturation: number, value: number) => void",signature:{arguments:[{type:{name:"number"},name:"saturation"},{type:{name:"number"},name:"value"}],return:{name:"void"}}},description:""},hue:{required:!0,tsType:{name:"number"},description:""},saturation:{required:!1,tsType:{name:"number"},description:""},showLoupe:{required:!1,tsType:{name:"boolean"},description:""},value:{required:!1,tsType:{name:"number"},description:""},width:{required:!0,tsType:{name:"number"},description:""},height:{required:!0,tsType:{name:"number"},description:""},onStart:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDownChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(isDown: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isDown"}],return:{name:"void"}}},description:""}}};function F({nobRadius:a=8,onChange:e,hue:r,saturation:t=1,showLoupe:i=!0,value:n=1,width:o=192,height:u=192,...s}){const m=t*o,l=(1-n)*u,[f,g]=d.useState(!1),T=N(s.onStart,s.onEnd),V=d.useMemo(()=>c=>{if(c.key==="ArrowLeft"||c.key==="ArrowRight"){T();const w=.01*(c.key==="ArrowLeft"?-1:1),b=y(t+w,0,1);e(b,n),c.preventDefault()}else if(c.key==="ArrowUp"||c.key==="ArrowDown"){T();const w=.01*(c.key==="ArrowUp"?1:-1),b=y(n+w,0,1);e(t,b),c.preventDefault()}},[t,n,e,T]),_=d.useCallback(()=>{g(!0)},[]),x=d.useCallback(()=>{g(!1)},[]),L=d.useMemo(()=>S({onDown:c=>{var h;return g(!0),(h=s.onStart)==null||h.call(s),{startX:c.clientX,startY:c.clientY,s:t,v:n}},onMove:(c,h)=>{if(!h)return;const w=c.clientX-h.startX,b=c.clientY-h.startY,j=y(h.s+w/o,0,1),H=y(h.v-b/u,0,1);e(j,H)},onUp:()=>{var c;g(!1),(c=s.onEnd)==null||c.call(s)}}),[e,t,n,o,u,s.onEnd,s.onStart]),q=d.useMemo(()=>M(C({h:r,s:t,v:n})),[r,t,n]),E=d.useMemo(()=>({h:r,s:t,v:n}),[r,t,n]),I=U(E);return v.jsxs("div",{className:"cmpui_sv-picker__root",tabIndex:0,onKeyDown:V,onFocus:_,onBlur:x,children:[v.jsx(R,{width:o,height:u,hue:r,onChange:e,onDownChange:g}),i&&f&&v.jsx(Y,{nobRadius:a,x:m,y:l,color:q}),v.jsx(X,{className:"cmpui_sv-picker__nob",fill:q,onPointerDown:L,radius:a,strokeColor:I,strokeWidth:2,x:m,y:l})]})}F.__docgenInfo={description:"",methods:[],displayName:"SVPicker",props:{nobRadius:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"8",computed:!1}},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(saturation: number, value: number) => void",signature:{arguments:[{type:{name:"number"},name:"saturation"},{type:{name:"number"},name:"value"}],return:{name:"void"}}},description:""},hue:{required:!0,tsType:{name:"number"},description:""},saturation:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},showLoupe:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},value:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"192",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"192",computed:!1}},onStart:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{F as S,ne as W,U as a,B as g,C as h,M as r,N as u};
